# from-scratch-recommender-spark
Content-based and collaborative filtering from scratch in Apache Spark

### Content-based filtering

Content-based filtering uses item features to recommend other items similar to what the user likes, based on their previous actions or explicit feedback.

**How It Works**

1. Represent each item as a vector of features

    * Features could be:

        * Text: keywords, tags, categories (e.g., “Action”, “Romance”)

        * Numerical: price, rating, popularity score

        * Embeddings: generated by NLP models for text, or CNNs for images

2. Build a user profile vector

    * Aggregate features of items the user liked/rated highly.

3. Compute similarity between the user profile and candidate items

    * Common similarity measures: cosine similarity, dot product, Pearson correlation.

4. Rank and recommend items with the highest similarity scores.

**Example**

Let’s say we’re recommending movies.

```
| user_id | item_id | rating |
| ------- | ------- | ------ |
|       1 | A       |      5 |
|       1 | C       |      3 |

```

```
| item_id | Action | Comedy | Drama |
| ------- | ------ | ------ | ----- |
| A       |      1 |      0 |     1 |
| B       |      0 |      1 |     1 |
| C       |      1 |      1 |     0 |  

```
If the user with id 1 liked A and C:

- Movie A: [5, 0, 5]
- Movie C: [3, 3, 0]
- Sum: [8, 3, 5]
- Norm: [0.78, 0.29, 0.49]

Now the user vector reflects:
- Strongest preference for Action
- Next for Drama
- Least for Comedy

**✅ Pros**
- The model doesn't need any data about other users, since the recommendations are specific to this user. This makes it easier to scale to a large number of users.
- The model can capture the specific interests of a user, and can recommend niche items that very few other users are interested in.

**❌ Cons**
- Since the feature representation of the items are hand-engineered to some extent, this technique requires a lot of domain knowledge. Therefore, the model can only be as good as the hand-engineered features.
- The model can only make recommendations based on existing interests of the user. In other words, the model has limited ability to expand on the users' existing interests.
